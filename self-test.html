
<!doctype html><html lang="ru"><head><meta charset="utf-8"><title>CFG Self-Test</title></head>
<body>
<h1>Self-Test</h1>
<button id="get">GET</button>
<button id="post">POST</button>
<pre id="log"></pre>
<script>
var CFG=(window.__CFG)||{};
var url = CFG.APPS_SCRIPT_URL || '';
function log(o){ var el=document.getElementById('log'); el.textContent += (typeof o==='string'?o:JSON.stringify(o,null,2)) + "\n"; }
document.getElementById('get').onclick = async ()=>{
  if(!url){ return log('APPS_SCRIPT_URL is empty'); }
  const r = await fetch(url+'?__selftest=1',{mode:'cors'});
  try{ log(await r.json()); }catch(e){ log('not JSON:'+await r.text()); }
};
document.getElementById('post').onclick = async ()=>{
  if(!url){ return log('APPS_SCRIPT_URL is empty'); }
  const payload = { action:'selftest', name:'Test', locale:document.documentElement.lang||'ru', page_url:location.href };
  const r = await fetch(url, { method:'POST', mode:'cors', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload) });
  try{ log(await r.json()); }catch(e){ log('not JSON:'+await r.text()); }
};
</script>
</body></html>
